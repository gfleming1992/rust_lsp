# 8.1.1.7.6 Impedance SpecRef Instantiation

There are 5 different parent element types to which a `SpecRef` child element can be added to reference an impedance specification. They are listed in order of precedence, in the event that more than one impedance SpecRef covers the same net or segment of net.

## 8.1.1.7.6.1 LayerFeature:Set

An impedance SpecRef at this level defines the impedance of a given segment of a net on a given layer. The net is identified by the value of the `net` attribute of the `Set` element. The transmission type specified in the referenced Spec **must** match the transmission type of the net. For example, a Spec for transmission type `SingleEnded` should not be referenced by a SpecRef on a net of transmission type `EdgeCoupled`.

If all segments of a given net on a layer are defined under the same `Set` element, a single SpecRef can define the impedance for all segments of the net on that layer. This is useful when defining the impedance of, for example, an EdgeCoupled net on a layer, while other EdgeCoupled nets on that layer have different impedance requirements.

Example:
```xml
<LayerFeature layerRef="TOP">
    <Set net="TX_P" netPair="TX_N">
        <SpecRef id="diff100"/>
        <Features>
            <Location x="0.0" y="0.0"/>
            <Polyline>
                <PolyBegin x="156.4760" y="-1.9535"/>
                <PolyStepSegment x="156.4760" y="-1.2189"/>
                <PolyStepSegment x="157.0000" y="-0.6949"/>
                <LineDesc lineEnd="ROUND" lineWidth="0.300000"/>
            </Polyline>
        </Features>
        <Features>
            <Location x="0.0" y="0.0"/>
            <Polyline>
                <PolyBegin x="167.5785" y="15.6010"/>
                <PolyStepSegment x="166.8439" y="15.6010"/>
                <PolyStepSegment x="166.3199" y="16.1250"/>
                <LineDesc lineEnd="ROUND" lineWidth="0.300000"/>
            </Polyline>
        </Features>
    </Set>
</LayerFeature>
```

## 8.1.1.7.6.2 StackupLayer

An impedance SpecRef at this level defines the impedance of a given transmission type and line width across the whole layer. For example, if the SpecRef references a Spec for transmission type `SingleEnded` and line width `0.3mm`, it applies to all net segments of transmission type `SingleEnded` and line width `0.3mm` on that layer. There may be another SpecRef for a different line width.

Example:
```xml
<StackupLayer layerOrGroupRef="TOP" thickness="0.0559" tolPlus="0.0056" tolMinus="0.0056">
    <SpecRef id="IMPEDANCE_SPEC_LAYER_TOP"/>
</StackupLayer>
```

## 8.1.1.7.6.3 LogicalNet

An impedance SpecRef at this level defines the impedance of all segments of a given net on all layers. The TransmissionType of the referenced Spec is omitted, so only the impedance value and optional tolerance are specified. TransmissionType and physical properties (line width, spacing, etc.) can change across layers to match the specified impedance value.

Example:
```xml
<LogicalNet name="TX_P" netPair="TX_N">
    <PinRef componentRef="IC50" pin="22"/>
    <PinRef componentRef="R32" pin="1"/>
    <SpecRef id="100ohms"/>
</LogicalNet>
```

## 8.1.1.7.6.4 StackupGroup

An impedance SpecRef at this level defines the impedance of a given transmission type and line width across the whole StackupGroup. For example, a SpecRef referencing a Spec for transmission type `SingleEnded` and line width `0.3mm` applies to all net segments of transmission type `SingleEnded` and line width `0.3mm` in that StackupGroup. There may be another SpecRef for a different line width.

Example:
```xml
<StackupGroup name="GROUP_PRIMARY" thickness="0.035" tolPlus="0" tolMinus="0">
    <StackupLayer layerOrGroupRef="L1" thickness="0.02" tolPlus="0" tolMinus="0"/>
    <StackupLayer layerOrGroupRef="L2" thickness="0.015" tolPlus="0" tolMinus="0"/>
    <SpecRef id="GROUP_PRIMARY_SPEC"/>
</StackupGroup>
```

## 8.1.1.7.6.5 Stackup

An impedance SpecRef at this level defines the impedance of a given transmission type and line width across the whole Stackup. For example, a SpecRef referencing a Spec for transmission type `SingleEnded` and line width `0.3mm` applies to all net segments of transmission type `SingleEnded` and line width `0.3mm` in the Stackup. There may be another SpecRef for a different line width.

Example:
```xml
<Stackup name="PRIMARY" overallThickness="2.23" tolPlus="0" tolMinus="0" whereMeasured="MASK">
    <SpecRef id="diff100"/>
    <SpecRef id="STANDARD_NOTES"/>
</Stackup>
```
